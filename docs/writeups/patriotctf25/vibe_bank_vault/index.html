<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vibe Bank Vault | Dead Pirate Society</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://batamladen.github.io/Dead-Pirate-Society/css/mobile.css">
  <link rel="icon" type="image/x-icon" href="https://batamladen.github.io/Dead-Pirate-Society/images/dps.ico">

  <style>
    :root {
      --bg: #080908;
      --text: #dbceb4;
      --link: #b43f26;
      --link-hover: #ff6347;
      --card-bg: #1a1a1a;
      --card-border: #333;
    }

    * { box-sizing: border-box; }

    body {
      background-color: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: system-ui, sans-serif;
      margin: 0;
      text-align: center;
      padding-top: 80px;
      min-height: 90vh;
      position: relative;
    }

    h1, h2 { font-family: 'Press Start 2P', cursive; color: var(--text); }
    p, li { font-family: 'Fira Mono', monospace; color: var(--text); }
    h1 { font-size: 1.2rem; line-height: 1.5; margin-bottom: 30px; text-transform: uppercase; }

     
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: var(--bg);
      border-bottom: 1px solid #333;
      z-index: 1000;
      height: 70px;
    }

    .logo {
      width: 60px;
      height: auto;
      animation: spin 15s linear infinite;
    }

    .nav-links { display: flex; gap: 20px; }
    .nav-links a {
      color: var(--link);
      text-decoration: none;
      font-weight: bold;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.7rem;
      transition: color 0.3s ease;
    }
    .nav-links a:hover { color: var(--link-hover); }

    .menu-icon {
      display: none;
      flex-direction: column;
      cursor: pointer;
      padding: 5px;
    }
    .menu-icon span {
      width: 25px;
      height: 3px;
      background: var(--link);
      margin: 3px 0;
      transition: 0.3s;
    }

     
    .mobile-nav {
      position: fixed;
      top: 0;
      right: -100%;
      width: 250px;
      height: 100vh;
      background: var(--card-bg);
      border-left: 2px solid var(--card-border);
      display: flex;
      flex-direction: column;
      padding: 80px 30px 30px;
      transition: right 0.3s ease;
      z-index: 999;
    }
    .mobile-nav.active { right: 0; }
    .mobile-nav a {
      color: var(--link);
      text-decoration: none;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.8rem;
      padding: 15px 0;
      border-bottom: 1px solid #333;
      transition: color 0.3s ease;
    }
    .mobile-nav a:hover { color: var(--link-hover); }

    .close-nav {
      position: absolute;
      top: 20px;
      right: 20px;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      font-family: system-ui, sans-serif;
    }

    .nav-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      z-index: 998;
    }
    .nav-overlay.active { display: block; }

    main {
      width: 100%;
      max-width: 800px;
      padding: 20px;
      text-align: left;
    }

    main img {
      display: block;
      max-width: 100%;
      margin: 15px auto;
      border-radius: 8px;
      cursor: zoom-in;
      transition: 0.2s ease;
    }

    code { background-color: #2d2d2d; color: #f8f8f2; padding: 2px 6px; border-radius: 3px; }
    pre { background-color: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 4px; border-left: 4px solid #ff6347; }
    pre code { background-color: transparent; padding: 0; }


    #img-lightbox {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    #img-lightbox img {
        max-width: 90%;
        max-height: 90%;
        border-radius: 10px;
        cursor: zoom-out;
    }


    footer {
      text-align: center;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.6rem;
      width: 100%;
      padding: 20px 0;
      margin-top: 100px;
    }

    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

     
  </style>
</head>
<body>

<header>
  <a href="https://batamladen.github.io/Dead-Pirate-Society/" class="logo-link">
    <img src="https://batamladen.github.io/Dead-Pirate-Society/images/DPSlogo.webp" alt="Logo" class="logo">
  </a>

  
  <div class="nav-links">
    <a href="https://batamladen.github.io/Dead-Pirate-Society/about/">ABOUT</a>
    <a href="https://batamladen.github.io/Dead-Pirate-Society/writeups/">WRITEUPS</a>
    <a href="https://batamladen.github.io/Dead-Pirate-Society/members/">MEMBERS</a>
    <a href="https://batamladen.github.io/Dead-Pirate-Society/achievements/">ACHIEVEMENTS</a>
  </div>

  
  <div class="menu-icon" id="menu-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</header>


<div class="nav-overlay" id="nav-overlay"></div>


<div class="mobile-nav" id="mobile-nav">
  <span class="close-nav" id="close-nav">✕</span>
  <a href="https://batamladen.github.io/Dead-Pirate-Society/about/">ABOUT</a>
  <a href="https://batamladen.github.io/Dead-Pirate-Society/writeups/">WRITEUPS</a>
  <a href="https://batamladen.github.io/Dead-Pirate-Society/members/">MEMBERS</a>
  <a href="https://batamladen.github.io/Dead-Pirate-Society/achievements/">ACHIEVEMENTS</a>
</div>

<main>

  <p style="text-align: center;">
    Writeup by 
    <a href="https://pointerpointer.com/" target="_blank" style="color: var(--link);">
      Phil
    </a>
  </p>

  <h1 style="text-align: center;">Vibe Bank Vault</h1>

  
  <h2 id="walkthrough">Walkthrough</h2>
<h3 id="core-bug">Core bug</h3>
<p>vibe_hash only hashes payload[: len(payload) % 256] and then bcrypt truncates the input to 72 bytes. With the static salt, any two inputs that share the same first min(len(payload) % 256, 72) bytes collide. Lengths that are multiples of 256 hash the empty string.</p>
<h3 id="level-by-level">Level-by-level</h3>
<ul>
<li>
<p>Level 1: The secret is 140 chars, but bcrypt only sees the first 72. The first 70 are leaked. Brute-forced the remaining 2 base62 chars (62^2 = 3844 options) with multiprocessing until <code>bcrypt.checkpw</code> matched the provided hash.</p>
</li>
<li>
<p>Level 2: Pick two different strings that start with the given prefix and have lengths that are multiples of 256/512. The hash portion is empty in both cases, so the hashes match.</p>
</li>
<li>
<p>Level 3: Target length 300–500 means the hash depends on <code>remainder = target_len % 256</code>, truncated to 72. Sent <code>&quot;B&quot;*min(remainder, 72)</code> (length different from the target) to collide.</p>
</li>
<li>
<p>Level 4: Target is <code>C... + fire emojis</code>. When the total byte length exceeds 72, bcrypt only sees the first 72 bytes. Sent the target truncated to 72 bytes (all Cs plus as many full fire emojis as fit) so the hash matched while staying under the 72-byte input limit.</p>
</li>
<li>
<p>Level 5: Let <code>r = (len(prefix) + admin_pw_len) % 256</code>. The hashed portion is <code>(prefix + &quot;X&quot;... )[:r]</code> (truncated again to 72 if needed). If <code>r &lt; len(prefix)</code>, sent any string of length <code>r + 239</code> so the portion is just the first r bytes of the prefix. Otherwise sent <code>&quot;X&quot; * (r - len(prefix))</code> so the portion matches the admin’s prefix + X padding.</p>
</li>
</ul>
<h3 id="automation">Automation</h3>
<p><code>solve.py</code> implements the above logic and uses a parallel brute-force for level 1:
<code>python solve.py --workers 16</code></p>
<p>Successful run returns the flag after clearing all five layers.</p>
<h3 id="flag">Flag</h3>
<pre tabindex="0"><code>PCTF{g00d_v1b3s_b4d_3ntropy_sync72_b4ck1ng}
</code></pre>

</main>

<footer>
  <p>@ DEAD PIRATE SOCIETY</p>
</footer>


    <div id="img-lightbox">
        <img src="" alt="Expanded Image">
    </div>

<script>
  const images = document.querySelectorAll("main img");
  const lightbox = document.getElementById("img-lightbox");
  const lightboxImg = lightbox.querySelector("img");

  images.forEach(img => {
      img.addEventListener("click", () => {
      lightboxImg.src = img.src;
      lightbox.style.display = "flex";
      });
  });

  lightbox.addEventListener("click", () => {
      lightbox.style.display = "none";
  });

  
  const menuIcon = document.getElementById('menu-icon');
  const mobileNav = document.getElementById('mobile-nav');
  const closeNav = document.getElementById('close-nav');
  const navOverlay = document.getElementById('nav-overlay');

  menuIcon.addEventListener('click', () => {
    mobileNav.classList.add('active');
    navOverlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  });

  closeNav.addEventListener('click', () => {
    mobileNav.classList.remove('active');
    navOverlay.classList.remove('active');
    document.body.style.overflow = '';
  });

  navOverlay.addEventListener('click', () => {
    mobileNav.classList.remove('active');
    navOverlay.classList.remove('active');
    document.body.style.overflow = '';
  });

  mobileNav.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileNav.classList.remove('active');
      navOverlay.classList.remove('active');
      document.body.style.overflow = '';
    });
  });
</script>

</body>
</html>
